## 死锁检测和解除

- 若系统为进程分配资源时不采取任何措施，应该提供死锁检测和解除的手段

### 资源分配图

- **圆圈**代表一个**进程**

- **框**代表一类**资源**

- **圈到框**代表进程**申请资源**

- **框到圈**代表资源**分配**给进程

![死锁资源分配](https://github.com/YC-L/Postgraduate-examination/blob/Operating-System/imgs/%E6%AD%BB%E9%94%81%E8%B5%84%E6%BA%90%E5%88%86%E9%85%8D%E5%9B%BE.png "死锁资源分配")

### 死锁定理

- 通过简化资源分配图的方法来判断是否死锁

- 找出**既不阻塞又不是孤点的进程**，消去请求边和分配边，使之成为孤立的点

- 当且仅当资源分配图**不可完全简化(有环)**，**可能**是死锁的

- 每种资源只有一个，又出现了环路，是**死锁的充分必要条件**

### 注意

- 环路存在**不一定**有死锁

- 只存在**一个资源实例**时，环路是死锁存在的**充分必要**条件

![资源分配图化简](https://github.com/YC-L/Postgraduate-examination/blob/Operating-System/imgs/%E8%B5%84%E6%BA%90%E5%88%86%E9%85%8D%E5%9B%BE%E5%8C%96%E7%AE%80.png "资源分配图化简")

### 死锁解除

- 一旦检测出死锁，就应采取相应的措施，以解除死锁

- **资源剥夺法**，挂起死锁进程，**抢占其资源**分配给其它死锁进程

- 应防止被挂起的进程长时间得不到资源，而处于资源匮乏的状态

- **撤销进程法**，**强制撤销**部分、甚至全部死锁的进程并剥夺进程资源

- 撤销的原则可以按进程优先级和撤销进程代价高低进行

- **进程回退法**，让一或多个进程**回退到足以回避死锁的地步**

- 进程回退时**自愿释放资源**而不是被剥夺，要求系统保持进程的历史信息，设置 还原点





## 进程的概念和特征

### 进程(Process)

### 引入进程的目的

- 实现操作系统的**并发行**和**共享性**，提高系统利用率和系统吞吐量

### 进程控制块 PCB（ProcessControlBlock）

- 由程序段、相关数据段和PCB构成了**进程映像**（进程实体）

- **PCB**是进程存在的**唯一标志**!

- 进程，是进程实体的运行过程，是系统**资源分配和调度**的一个独立单位

- PCB常驻于由OS维护的**内存核心区**，不能由应用程序自身的代码来直接访问，而要通过**系统调用间接访问**

- OS专门开辟PCB区将所有的PCB组织成**若干个链表或队列**

### PCB包含的信息

##### 进程标识符信息

- **唯一的标识符**，可以是字符串，也可以是一个数字

- UNIX系统中就是一个整型数。在进程创建时由系统赋予

- 进程标识符用于唯一的标识一个进程。一个进程通常有以下两种标识符

- 外部标识符。由创建者提供，通常是由字母、数字组成，往往是用户（进程）访问该进程使用

- 外部标识符便于记忆，如：计算进程、打印进程、发送进程、接收进程

- 内部标识符：为了方便系统使用而设置的。在所有的OS中，都为每一个进程赋予一个唯一的整数，作为内部标识符

- 它通常就是一个进程的符号，为了描述进程的家族关系，还应该设置父进程标识符以及子进程标识符

- 还可以设置用户标识符，来指示该进程由哪个用户拥有

##### 处理机状态信息

- 说明进程当前所处的状态

- 为了管理的方便，系统设计时会将相同的状态的进程组成一个队列，如就绪进程队列，等待进程则要根据等待的事件组成多个等待队列，如等待打印机队列、等待等

- 处理机状态信息主要是由**处理机各种寄存器中的内容**所组成

- 通用寄存器。又称为用户可视寄存器，可被用户程 序访问，用于暂存信息。

- 指令寄存器。存放要访问的下一条指令的地址。

- 程序状态字PSW。其中含有状态信息。（条件码、 执行方式、中断屏蔽标志等）

- 用户栈指针。每个用户进程有一个或若干个与之相 关的系统栈，用于存放过程和系统调用参数及调用地址。栈指针指向该栈的栈顶

##### 进程调度信息

- 进程状态。指明进程当前的状态，作为进程调度和对换时的依据。

- 进程优先级。用于描述进程使用处理机的优先级别的一个整数，优先级高的进程优先获得处理机。

- 进程调度所需要的其他信息（进程已等待CPU的时间总和、进程已执行的时间总和）

- 事件，这是进程由执行状态转变为阻塞状态所等待发生的事件。（阻塞原因）

##### 进程上下文(进程控制信息)

- 是进程执行活动全过程的静态描述

- 包括计算机系统中与执行该进程有关的各种寄存器的值、程序段在经过编译之后形成的机器指令代码集、数据集及各种堆栈值和PCB结构

- 可按一定的执行层次组合，如用户级上下文、系统级上下文

- 进程存在的唯一标志：在进程的整个生命周期中，系统总是通过PCB对进程进行控制的，亦即，系统是根据进程的PCB而不是任何别的什么而感知到该进程的存在的，所以说，PCB是进程存在的唯一标志

### 内存中的进程

- 进程不只是程序代码，程序代码有时称为**文本段**(代码段)

- 进程还包括当前活动，通过程序计数器的值和处理器寄存器的内容表示

- 进程还包括进程**堆栈段**(包括临时数据，如函数参数，返回地址和局部变量)和**数据段**(包括全局变量)

- 进程还可能包括**堆**(heap)，在进程运行期间动态分配的内存

![image](https://github.com/YC-L/Postgraduate-examination/blob/Operating-System/imgs/Process-in-memory.png)

### 进程和程序的关系

- 程序是**被动/静态实体**

- 进程是**动态过程**

- 通过多次执行，一个程序可**产生**多个进程

- 通过调用关系，一个进程可**包括**多个程序

### 进程特征

- 动态性

- 并发性

- 独立性

- 异步性

- 结构性

### 五种进程状态的转换(不带挂起状态)

![五状态模型](https://github.com/YC-L/Postgraduate-examination/blob/Operating-System/imgs/%E4%BA%94%E7%8A%B6%E6%80%81%E6%A8%A1%E5%9E%8B.png "五状态模型")

- 就绪->运行：获得**处理机资源**后，进程由就绪态转换为运行态

- 运行->就绪：处于运行态的进程在**时间片用完**后，让出处理机，变为就绪
- 在***可剥夺*** 操作系统中，当有**更高优先级**进程**就绪**，正运行的进程转为就绪态

- 运行->阻塞：当进程请求某资源的使用和分配或等待某一事件发生（I/O操作)
- 由**目态**程序调用操作系统内核过程的形式

- 阻塞->就绪：**等待事件结束**，I/O操作结束或中断结束，由阻塞变为就绪

- 运行->阻塞，是一个**主动行为**

- 阻塞->就绪，是一个**被动行为**

### 就绪态和等待态的区别

- 就绪态，只**缺少处理机**，只要获得处理机资源就可以立即执行

- 等待态，进程需要其他资源（除了处理机）或等待某一事件


### 典型例题

- 涉及某一资源造成与时间有关的错误的原因，若干并发进程同时使用该资源
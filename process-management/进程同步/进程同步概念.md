## 进程同步的基本概念

- 进程并发地对共享数据的访问有可能引起数据的不一致性

- 为了维持数据的一致性，必须有一种机制来保证协作进程之间按某种正确的次序执行

### 临界资源

- 一次仅允许一个进程使用的资源

- 硬件或软件(如外设、共享代码段、共享数据结构)

- 多个进程在对其进行访问时(关键是进行写入或修改)，必须互斥地进行

### 临界区

- 访问临界资源的那段**代码**

#### 不适合处机调度的情况

- 在处理**中断**的过程中

- 进程在**操作系统内核程序临界区**中

- 其他需要完全屏蔽中断的原子操作过程中

### 同步

- **直接制约**关系，要在某些位置上协调工作次序而等待、传递信息所产生的制约关系

#### 同步机制应遵循的准则

- **空闲则入**：其他进程均不处于临界区，应允许请求进入临界区的进程进入

- **忙则等待**：已有进程处于其临界区，请求进入临界区的进程应等待

- **有限等待**：等待进入临界区的进程不能"死等"

- **让权等待**：不能进入临界区的进程，应释放CPU（如转换到阻塞状态）


### 互斥

- **间接制约**关系，当一个进程进入临界区使用临界资源时，另一个进程必须等待

- 当占用临界资源的进程退出临界区后其他进程才能去访问临界资源

### 实现临界区互斥的基本方法

#### 软件实现方法

##### 单标志法

##### 双标志法先检查

##### 双标志法后检查，可能因为互相谦让，导致"饥饿"现象

##### Peterson's Algorithm,1和4的结合

```cpp

Pi进程                                   Pj进程

void Pi(){       				void Pj(){
	......						......
	flag[i]=TRUE;trun=j			flag[j]=TRUE;turn=i;
	while(flag[j]&&turn==j)；	while(flag[i]&&turn==i)；
	critical section;			critical section;
	flag[i]=FALSE;              flag[i]=FALSE;
	remainder section;          remainder section;
	......                      ......
}

```


#### 硬件实现方法

- 中断屏蔽方法，禁止一切中断发生

- 硬件指令方法
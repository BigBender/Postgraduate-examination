## 页面分配策略

### 驻留集大小(为进程分配的页框数)

#### 固定分配 局部置换

- 为每个进程分配**一定数目**物理块(页框)，在整个运行期间不改变

- 发生缺页时，从该进程在内存中的页面中选出一页换出，整个运行期间都不改变

- 难以确定分配的物理块数目，太少会频繁缺页，太多降低CPU和其他资源利用率

#### 可变分配全局置换

- 为每个进程分配**一定数目**物理块(页框)

- 操作系统自身也保持一个**空闲物理队列**，缺页时，从空闲物理块队列**取出一个物理块分配**给该进程

- 动态增加进程物理块，会导致系统**多道程序并发能力下降**

#### **可变**分配**局部**置换(结合了前两个的优势)

- 为每个进程分配**一定数目**物理块(页框)

- 发生缺页时，只允许从该进程在内存的页面中换出一页

- 如果**频繁缺页**，系统为进程**分配若干物理块**，直到进程缺页率趋于适当程度

- 如果进程运行中**缺页率特别低**，则可**适当减少分配**给该进程的物理块

- 既可动态增加物理块，也可动态减少物理块，保证系统不会过多调页，也保持了系统多道程序并发能力

### 调入页面的时机

#### 预调页策略，运行前调入

- 根据**局部性原理**，采用以**预测为基础**的预调页策略，将预计不久后访问的页面预先调入内存

- 预调页成功率仅约 50%

#### 请求调页策略，运行间调入，每次只调一页

- 易于实现，调入调出页面数多时会花费过多的IO开销

### 从何处调页

- 系统**拥有足够对换区空间**，全部从对换区调入所需，提高调页速度

- 系统缺**少足够的对换区空间**，凡不会被修改的从**文件区调入**，可能修改的需要调到对换区

- UNIX方式

- 与进程有关的文件放文件区

- **未运行过**的页面，应从**文件区**调入

- **曾运行过**页面从**对换区**调入，请求的共享页面无需从对换区调入

### 抖动(颠簸)

**频繁**的页面调度行为

#### 抖动的原因

- 某个进程频繁访问的页面数**高于可用**的物理页帧数

- 虚拟内存技术可以在内存中**保留更多进程**，提高系统效率

- 如果**管理不当**，处理机大部分时间都**将用于交换块**，而不是执行进程的指令

#### 内存页锁定

- 正在进行I/O操作的页不应该换出，即要锁定。

- 另一种解决是I/O操作在核心缓冲区进行（不占用页框），操作完成后复制到用户页（UNIX做法）


### 工作集

- 驻留集，某段时间间隔内，**进程要访问的页面***集合*，是去掉重复元素的集合

- 经常被使用的页面需要在工作集中，而**长期不用**的页面从工作集中**抛弃**

- 为了**防止系统出现抖动现象**，需要**选择**合适的工作集**大小**

#### 工作集模型的原理

- 操作系统跟踪每个进程的工作集，为进程分配大于工作集的物理块

- 若还有空闲物理块，再调一个进程到内存以增加多道程序数

- 若所有工作集之和**超过**了可用物理块总数，操作系统会**暂停一个进程**，将页面调出，防止抖动



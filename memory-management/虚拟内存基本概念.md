## 虚拟内存的基本概念

### 虚拟内存

- 虚拟内存将用户逻辑内存与物理内存分开，在现有物理内存有限的情况下，提供了巨大的虚拟内存

- 进程的**虚拟地址空间**就是进程如何在内存中存放的逻辑视图

![image](https://github.com/YC-L/Postgraduate-examination/blob/Operating-System/imgs/Memory-mapping.png)

虚拟内存大于物理内存的图

![image](https://github.com/YC-L/Postgraduate-examination/blob/Operating-System/imgs/Virtual-address-space.png)

#### 虚拟地址空间(受计算机系统地址空间限制)

- 随着动态内存分配，堆可向上生长

- 随着子程序不断调用，栈可以向下生长

- 栈与堆之间巨大空白空洞为虚拟地址的一部分

- 只有在堆与栈生长时，才需要实际的物理页

- **稀地址空间**：包括空白的虚拟地址空间

### 传统存储管理方式的特征

- **一次性**，作业必须**一次性全部装入**内存

- **驻留性**，作业被装入内存后，**一直驻留**在内存中，直到作业运行结束

### 局部性原理(虚拟存储技术基于局部性原理)

- 快表，页高速缓存以及虚拟内存技术，都是属于**高速缓存**技术，依赖**局部性原理**

- **时间**局部性，一条指令程序一旦执行，**不久后可能再次执行**，例如循环

- **空间**局部性，程序访问了某个存储单元，不久之后**附近的存储单元也被访问**

- **顺序**局部性，在典型程序中，除转移类指令外，大部分指令是顺序进行的。
</br>顺序执行和非顺序执行的比例大致是5:1。
</br>此外，对**大型数组访问**也是顺序的。
</br>指令的顺序执行、数组的**连续存放**等是产生顺序局部性的原因

- 根据**局部性原理**这个理论，Denning提出了**工作集**理论

### 虚拟存储器

- 应用程序在运行之前，没有必要全部装入内存，仅须将那些**当前要运行的少数页面或段先装入内存**便可运行，其余部分暂留在盘上

- 这种存储器实际上并不存在，由于系统提供了部分装入，请求调入和置换功能(**对用户透明**)，给用户感觉比实际存储器大得多得存储器

- 虚拟存储器的容量 = **min**{计算机地址空间, 内存+辅存}

- 操作系统将内存中**暂时不使用的内容**换到外存上，腾出空间存放**将要调入内存**的信息

- 多次性，允许**多次调入**内存运行

- 对换性，允许作业运行过程中，**进行换进和换出**

- 虚拟性，指从**逻辑上扩充**内存容量

- 离散性，进程的物理地址空间不连续

#### 典型例题

- 段逻辑地址形式: 段号13位，段内地址23位，内存1M，辅存100G，虚拟存储器最大实际容量为
- 虚拟存储器的容量 = min(计算机地址空间, 内存+辅存)
- 计算机地址空间为13位，2^13=64G，内存+辅存=1M+100G，所以64G

### 虚拟内存技术的实现

- **一定容量**的内存和外存

- 页表(页段)机制，作为主要数据结构

- **中断**机构，程序要访问的部分尚未调入内存，产生中断

- **地址变换**机构，逻辑地址到物理地址的变换







## 文件物理结构

- 文件的物理结构：又称文件的存储结构，**文件在外存上组织形式**，**与存储介质的存储性能有关**

### 连续文件结构

- 连续文件结构是由一组分配在磁盘**连续区域**的物理块组成

- 适用于变化不大的**顺序访问**的文件

### 串联文件结构

- 按顺序由串联的块组成的，文件的信息按存储介质的物理特性存于若干块中

- 每个物理块的最后一个字(或第一个字)作为链接字，指出**后继块的物理地址**

- 链首指针存放在该文件目录中，文件的**结尾块的指针**为"∧"，表示文件至本块结束

- 文件映照

- 把链接文件中的链接字集中在同一结构中，既**保持了链接文件的优点**，也**克服了缺点**

### 索引结构

- 系统为每个文件建立逻辑块号与物理块号的**对照表**，称为文件的索引表 

- 索引文件，由**数据文件**和**索引表**构成

### 典型例题

- 某文件有4个记录L0~L3，采用链接存储结构，每个记录及链接指针占用一个磁盘块，主存储器中的磁盘缓冲区的大小与磁盘块的大小相等

- 在L2和L3之间插入一个记录L2'(已经在内存中)，需要进行 3 次读盘，2 次写盘

- 找到L2，读3次，将L2'指向L3，将L2指向L2，两次写盘

- 某文件由30个盘块构成，设文件的目录项已经在内存，若为索引分配，其索引块也在内存

- 计算对于连续、链接和索引分配下列操作要多少次磁盘IO

- 在连续分配中，文件头前无空闲盘块，文件末尾有，要写的内容已经在磁盘，文件中间块是第15块

- 在文件头增加一块

- 采用顺序存储的方式，从头顺序遍历到结尾(30次读盘)，再向前遍历，将每个磁盘块后移(30次写盘)，最后在文件头加一块(1次写盘)，一共需要 61次磁盘操作

- 采用链接存储方式，只需要将要增加的磁盘块链接到文件头，一共需要1次写盘

- 采用索引分配方式，修改索引表增加一个指向

- 从文件中间删除一块

- 采用顺序存储方式，从头顺序遍历到第15个块(15次读盘)，从第16个块开始，将每个磁盘块前移(15次写盘)，共

- 采用链接存储方式，从头顺序遍历到第15个块(15次读盘)，将第15个块的后继指向第17个块(1次写盘)，共16次磁盘操作

- 采用索引分配方式，索引表中指向第15个块的索引失效，不需要磁盘操作
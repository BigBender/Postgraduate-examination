## 关键路径

- 在带权有向图中，顶点表示事件，有向边表示活动，**边上的权值**表示**完成该活动的开销**(完成活动所需时间)

- 称这种有向图为**用边表示活动的网络**

- 只有在某顶点所代表的**事件发生后**，从该顶点出发的各有向边所代表的**活动才能开始**

- 只有在进入某一顶点的各有向边所代表的**活动已经结束**时，该顶点所**代表的事件才能发生**

- 在AOE网中**仅有一个入度为0的顶点**，称为开始顶点(**源点**)，表示整个工程的**开始**

- 网中也**存在一个出度为0的顶点**，称为结束顶点(**汇点**)，表示整个工程的**结束**

- AOE网中，**有些活动可以并行进行**，从源点到汇点有向路径可能有多条，并且这些路径长度可能不同

- 完成不同路径上的活动所需时间虽然不同，但是**只有所有路径上的活动都完成了**，整个工程才**算是结束**

- 从源点到汇点所有路径中，具有*最大路径长度的路径*称为**关键路径**，把关键路径上的活动称为**关键活动**

- 完成整个工程的最短时间就是**关键路径的长度**，也就是关键路径上**各活动花费开销的总和**

- 因为关键活动影响了整个工程的时间，如果关键活动不能按时完成，完成时间就延长

- 只要找到了关键活动，就找到了关键路径，也可以得出**最短完成时间**

### 事件Vk的最早发生时间Ve(k)

- 它是指从开始顶点V到Vk的最长路径长度。事件的最早发生时间决定了所有从Vk开始的活动能够开工的最早时间

- Ve(源点)=0

- Ve(k)=Max{Ve(j) + Weight(Vj, Vk)}, Weight(Vj, Vk)表示<Vj, Vk>上的权值

- 注意：计算Ve时，是**从前往后**的顺序开始计算的

### 事件Vk的最迟发生时间Vl(k)

- 不推迟整个工程完成的前提下，保证它所指向的事件Vi在Ve(i)时刻能够发生时，该事件最迟必须发生的时间

- **Vl(汇点)=Ve(汇点)**

- Vl(j)=Min{Vl(k) - Weight(Vj, Vk)}，Weight(Vj, Vk)表示<Vj, Vk>的权值

- 注意：计算Vl(j)时是**从后往前**的顺序开始计算的

### 活动ai的最早发生时间ae(i)

- 它是指该活动的**起点**所表示的事件**最早发生事件**。如果边<Vk,Vj>表示活动ai，则有e(i)=Ve(k)

### 活动ai的最迟发生事件al(i)

- 它是指活动的**终点**所表示的事件**最迟发生时间与该活动所需时间之差**

- 如果边<Vk, Vj>表示活动ai，则有al(i)=vl(j)-Weight(Vk, Vj)

### 一个活动ai的最迟开始时间l(i)和其最早开始时间e(i)的差额d(i)=l(i)-e(i)

- 它是指该活动完成的时间余量，是在不增加完成整个工程所需的总时间的情况下，活动ai可以拖延的时间。

- 如果一个**活动的时间余量为零**时，**说明该活动必须要如期完成**，否则就会拖延完成整个工程的进度

- 所以称 al(i)-ae(i)=0，即al(i)=ae(i)得活动ai是关键活动

#### 求关键路径算法

- 求AOE网中所有时间得**最早发生时间Ve**

- 求AOE网中所有时间的**最迟发生时间Vl**

- 求AOE网中所有活动的**最早开始时间ae**

- 求AOE网中所有活动的**最迟开始时间al**

- 求AOE网中所有活动的差额d，找出所有d=0的活动构成关键路径

![image](https://github.com/YC-L/Postgraduate-examination/blob/DataStructure/imgs/Activity-on-edge-network.png)

<table style="border-collapse: collapse;">
	<tr>
		<th></th>
		<th>v1</th>
		<th>v2</th>
		<th>v3</th>
		<th>v4</th>
		<th>v5</th>
		<th>v6</th>
	</tr>
	<tr>
		<td>ve(i)</td>
		<td>0</td>
		<td>3</td>
		<td>2</td>
		<td>6</td>
		<td>6</td>
		<td>8</td>
	</tr>
	<tr>
		<td>vl(i)</td>
		<td>0</td>
		<td>4</td>
		<td>2</td>
		<td>6</td>
		<td>7</td>
		<td>8</td>
	</tr>
</table>

<table style="border-collapse: collapse;">
	<tr>
		<th></th>
		<th>a1</th>
		<th>a2</th>
		<th>a3</th>
		<th>a4</th>
		<th>a5</th>
		<th>a6</th>
		<th>a7</th>
		<th>a8</th>
	</tr>
	<tr>
		<td>ae(i)</td>
		<td>0</td>
		<td>0</td>
		<td>3</td>
		<td>3</td>
		<td>2</td>
		<td>2</td>
		<td>6</td>
		<td>6</td>
	</tr>
	<tr>
		<td>al(i)</td>
		<td>1</td>
		<td>0</td>
		<td>4</td>
		<td>4</td>
		<td>2</td>
		<td>5</td>
		<td>6</td>
		<td>7</td>
	</tr>
	<tr>
		<td>al(i)-ae(i)</td>
		<td>1</td>
		<td>0</td>
		<td>1</td>
		<td>1</td>
		<td>0</td>
		<td>3</td>
		<td>0</td>
		<td>1</td>
	</tr>
</table>

- 关键路径: v1->v3->v4->v6, 关键活动: a2, a5, a7

- 关键路径上所有活动都是关键活动，是决定整个工程的关键因素，**可通过加快关键活动缩短整个工程的工期**

- 但**不能任意缩短**，缩短到一定程度，该关键活动可能变成非关键活动

- 网中的关键路径并**不唯一**

- 对于有**几条**关键路径的网，只提高**一条**关键路径上的关键活动，**不能**缩短整个工程的工期

- 只有**加快所有**的关键路径上的关键活动才能缩短工期
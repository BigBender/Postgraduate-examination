## 设备分配与回收

### 设备分配概述

1. 独占式设备
2. 分时式共享使用设备，分时共享
3. 以SPOOLing方式使用的外部设备，假脱机，实质上是对I/O的批处理操作，空间换时间


### 设备分配的数据结构

- 设备控制表 DCT

存储设备的各个属性

每个设备控制表，都需要一个指向控制器控制表的一指针，因此DCT与COCT一对一关系

![设备控制表](https://github.com/YC-L/Postgraduate-examination/blob/Operating-System/imgs/%E8%AE%BE%E5%A4%87%E6%8E%A7%E5%88%B6%E8%A1%A8.png "设备控制表")

- 控制器控制表 COCT

设备控制器需要请求通道为它服务，每个COCT必定有一个表项存放指向相应通道控制表(CHCT)的指针

- 通道控制表 CHCT

一个通道可以为多个设备控制器服务，CHCT中必定有一个指针指向一个表，该表记录CHCT提供服务的那交给设备控制器，CHCT与COCT一对多关系

- 系统设备表 SDT

整个系统只有一张SDT，记录已连接系统中的所有物理设备的情况，每个物理设备占一个表项

![](https://github.com/YC-L/Postgraduate-examination/blob/Operating-System/imgs/COCT%2CCHCT%2CSDT.png "")

### 设备分配策略

1. 设备分配原则：充分发挥设备使用效率，避免造成进程死锁，将用户程序与设备隔离
2. 设备分配方式：静态和动态

**静态分配**

主要用于独占设备的分配，不会出现死锁，但是使用效率低

**动态分配**

在进程执行过程中根据需要分配，利于提高设备利用率，但分配算法使用不当，可能造成进程死锁

### 设备分配算法

先请求先分配，优先级高者优先等

### 设备分配安全性

设备分配中应防止发生进程死锁

1. 安全分配方式，每当进程发出I/O请求后进入阻塞状态，直到I/O操作完成才唤醒
2. 不安全分配方式，进程在发出I/O请求后继续运行，同时发出第二个、第三个I/O请求，仅当进程所请求设备被另一进程占用时，才进入阻塞状态

### 逻辑设备名到物理设备名

系统中设置一张逻辑设备表(LUT)，将逻辑设备名映射为物理设备名

两种建立方式

1. 只设置一张LUT，适用于单用户系统
2. 为每个用户设置一张LUT，用户登陆时，为用户建立一个进程，同时建立一张LUT，并将表放入进程的PCB中














